"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[653],{7113:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>a});var s=n(4848),i=n(8453);const o={},r="Remote attestation",c={id:"reference/attest",title:"Remote attestation",description:"Use remote attestation to verify that an EGo app is indeed running inside an enclave and to identify it by its hash.",source:"@site/docs/reference/attest.md",sourceDirName:"reference",slug:"/reference/attest",permalink:"/ego/pr-preview/pr-324/reference/attest",draft:!1,unlisted:!1,editUrl:"https://github.com/edgelesssys/ego/edit/master/docs/docs/reference/attest.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Configuration file",permalink:"/ego/pr-preview/pr-324/reference/config"}},l={},a=[{value:"Set up the quote provider",id:"set-up-the-quote-provider",level:2},{value:"Intel PCS (verifier only)",id:"intel-pcs-verifier-only",level:3},{value:"PCCS of your CSP",id:"pccs-of-your-csp",level:3},{value:"Your own PCCS",id:"your-own-pccs",level:3},{value:"Set up the PCCS",id:"set-up-the-pccs",level:4},{value:"Configure the quote provider",id:"configure-the-quote-provider",level:4}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"remote-attestation",children:"Remote attestation"})}),"\n",(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.em,{children:"remote attestation"})," to verify that an EGo app is indeed running inside an enclave and to identify it by its hash."]}),"\n",(0,s.jsx)(t.p,{children:"Attestation relies on external SGX services:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.em,{children:"Provisioning Certificate Caching Service (PCCS)"})," caches attestation data from Intel. It's either operated by the cloud provider or must be hosted by yourself."]}),"\n",(0,s.jsxs)(t.li,{children:["The ",(0,s.jsx)(t.em,{children:"quote provider"})," helps EGo to connect to the PCCS. Both the attester and the verifier must install it."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"set-up-the-quote-provider",children:"Set up the quote provider"}),"\n",(0,s.jsx)(t.p,{children:"Install the quote provider on all machines that should host or verify EGo apps:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'sudo mkdir -p /etc/apt/keyrings\nwget -qO- https://download.01.org/intel-sgx/sgx_repo/ubuntu/intel-sgx-deb.key | sudo tee /etc/apt/keyrings/intel-sgx-keyring.asc > /dev/null\necho "deb [signed-by=/etc/apt/keyrings/intel-sgx-keyring.asc arch=amd64] https://download.01.org/intel-sgx/sgx_repo/ubuntu $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/intel-sgx.list\nsudo apt update\nsudo apt install libsgx-dcap-default-qpl\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Locate its configuration file at ",(0,s.jsx)(t.code,{children:"/etc/sgx_default_qcnl.conf"}),".\nIf the file doesn't exist or is outdated, download it with the following command:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"wget -qO- https://raw.githubusercontent.com/intel/SGXDataCenterAttestationPrimitives/master/QuoteGeneration/qcnl/linux/sgx_default_qcnl.conf | sudo tee /etc/sgx_default_qcnl.conf > /dev/null\n"})}),"\n",(0,s.jsx)(t.p,{children:"You can configure the quote provider to get the collaterals from the Intel PCS, the PCCS of your cloud service provider (CSP), or your own PCCS."}),"\n",(0,s.jsx)(t.h3,{id:"intel-pcs-verifier-only",children:"Intel PCS (verifier only)"}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsx)(t.p,{children:"This method only supports verification. For configuring machines that host EGo apps, choose one of the other methods."})}),"\n",(0,s.jsxs)(t.p,{children:["Using the Intel PCS is the simplest and most generic way for verifying, but it may be slower and less reliable than a PCCS.\nConfigure it by uncommenting the ",(0,s.jsx)(t.code,{children:'"collateral_service"'})," key:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'  ,"collateral_service": "https://api.trustedservices.intel.com/sgx/certification/v4/"\n'})}),"\n",(0,s.jsx)(t.h3,{id:"pccs-of-your-csp",children:"PCCS of your CSP"}),"\n",(0,s.jsxs)(t.p,{children:["If you're running an EGo app in the cloud, it's recommended to use the PCCS of your CSP.\nSet the ",(0,s.jsx)(t.code,{children:'"pccs_url"'})," value to the respective address:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Azure: ",(0,s.jsx)(t.code,{children:"https://global.acccache.azure.net/sgx/certification/v4/"})]}),"\n",(0,s.jsxs)(t.p,{children:["See the ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/azure/security/fundamentals/trusted-hardware-identity-management#how-do-i-use-intel-qpl-with-trusted-hardware-identity-management",children:"Azure documentation"})," for more information on configuring the quote provider."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Alibaba: ",(0,s.jsx)(t.code,{children:"https://sgx-dcap-server.[Region-ID].aliyuncs.com/sgx/certification/v4/"})]}),"\n",(0,s.jsxs)(t.p,{children:["See the ",(0,s.jsx)(t.a,{href:"https://www.alibabacloud.com/help/en/ecs/user-guide/build-an-sgx-encrypted-computing-environment",children:"Alibaba documentation"})," for supported Region-ID values and more information on configuring the quote provider."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"your-own-pccs",children:"Your own PCCS"}),"\n",(0,s.jsx)(t.p,{children:"If you're running an EGo app on premises, you must host a PCCS yourself."}),"\n",(0,s.jsx)(t.h4,{id:"set-up-the-pccs",children:"Set up the PCCS"}),"\n",(0,s.jsxs)(t.p,{children:["To set up a PCCS, you can either follow ",(0,s.jsx)(t.a,{href:"https://download.01.org/intel-sgx/latest/dcap-latest/linux/docs/Intel_SGX_SW_Installation_Guide_for_Linux.pdf",children:"the instructions from Intel"})," or use our provided Docker image."]}),"\n",(0,s.jsx)(t.p,{children:"To do the latter, follow these steps:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Run the PCCS:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"docker run -p 8081:8081 --name pccs -d ghcr.io/edgelesssys/pccs\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Verify that the PCCS is running:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"curl -kv https://localhost:8081/sgx/certification/v4/rootcacrl\n"})}),"\n",(0,s.jsx)(t.p,{children:"You should see a 200 status code."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"configure-the-quote-provider",children:"Configure the quote provider"}),"\n",(0,s.jsxs)(t.p,{children:["In the configuration file, set the ",(0,s.jsx)(t.code,{children:'"pccs_url"'})," value to the address of your PCCS."]}),"\n",(0,s.jsxs)(t.p,{children:["If your PCCS runs with a certificate not signed by a trusted CA, you need to set ",(0,s.jsx)(t.code,{children:'"use_secure_cert"'})," to ",(0,s.jsx)(t.code,{children:"false"}),".\nThis instructs the quote provider to accept a self-signed certificate of the PCCS.\nIt doesn't affect the security of the remote attestation process itself."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var s=n(6540);const i={},o=s.createContext(i);function r(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);